# microgue 開発計画

## Phase 1: コアループ (基盤構築) ✅

### 1.1 基本フレームワーク ✅
- ゲームループの実装
- 入力処理システム
- 画面レンダリングシステム

### 1.2 基本エンティティ ✅
- プレイヤーエンティティ
- 敵エンティティ
- 基本ステータス (HP, ATK, DEF, SPD)

### 1.3 戦闘システム基盤 ✅
- ターン管理システム
- ダメージ計算
- 死亡判定

---

## Phase 2: 基本戦闘システム ✅

### 2.1 タイムラインシステム ✅
- APゲージの実装
- 行動順の決定
- ゲージ蓄積システム

### 2.2 戦闘アクション ✅
- 攻撃アクション
- 待機アクション
- 移動アクション

### 2.3 戦闘表示 ✅
- エンティティ配置の表示
- ステータス表示
- タイムラインゲージ表示
- ターン表示

---

## Phase 3: ダンジョンシステム ✅

### 3.1 ダンジョン生成 ✅
- グラフベースのダンジョン構造
- 部屋タイプ (通常/エリート/大群/宝物庫/ボス/スキップ)
- フロア進行システム

### 3.2 ナビゲーション ✅
- 部屋選択システム
- パス表示
- 進行管理

### 3.3 部屋エンカウント ✅
- 部屋タイプに応じた敵生成
- 敵の種類と数の決定
- 戦闘への移行

---

## Phase 4: アイテム・成長システム ✅

### 4.1 宝物システム ✅
- 宝物定義 (weapons.json, armors.json, relics.json)
- 装備システム
- ステータス補正の適用

### 4.2 報酬システム ✅
- 戦闘勝利報酬
- 宝物庫の報酬
- 装備選択画面

---

## Phase 5: メタプログレッション ✅

### 5.1 アンロックシステム ✅
- アンロック定義 (unlocks.json)
- 進捗管理
- アンロック条件の判定

---

## Phase 6: ボス戦・バランス調整 ✅

### 6.1 ボスエンティティ ✅
- ボス定義 (bosses.json)
- ボス戦闘システム
- ボス部屋の実装

### 6.2 敵バリエーション ✅
- 通常敵 (ゴブリン、オーク、スケルトン等)
- エリート敵
- ボス敵

### 6.3 バランス調整 ✅
- 敵のステータス調整
- 宝物効果の調整
- 難易度バランス

---

## Phase 7: フルゲーム統合 ✅

### 7.1 ゲームフロー統合 ✅
- ダンジョンナビゲーション → 戦闘 → 報酬のループ
- フロア進行管理
- 勝利/敗北条件

### 7.2 バグ修正 ✅
- タイムライン蓄積停止問題 (死亡エンティティの除去)
- 重複表示の修正
- 入力制御の修正
- 部屋選択バグの修正
- フロア番号の0オリジン化

### 7.3 プレイアビリティ ✅
- スタートからボス撃破までの完全なプレイスルー
- 敵ターン中の入力制御
- 戦闘状態の適切な表示

---

## Phase 8: 戦闘システム拡張（計画中）

### 8.1 基本ルール改善 【優先度: 高】
- **距離制限の実装**
  - 近接攻撃は隣接マスのみ可能に
  - 射程の概念を導入
- **重複装備の防止**
  - 同一宝物の複数装備を禁止
  - 装備チェック機能の追加

### 8.2 状態異常システム 【優先度: 高】
- **継続ダメージ (DoT)**
  - 毒、火傷などの実装
  - ターン経過でダメージ
- **継続回復 (HoT)**
  - 再生効果の実装
  - DoTへの対策
- **スタン効果**
  - ゲージ蓄積の阻害
  - 行動不能状態の実装

### 8.3 戦術的要素 【優先度: 中】
- **特殊アクション**
  - パリィ (受け流し)
  - カウンター (反撃)
  - ガード (防御)
- **ポジショニング**
  - 回り込み (フランキング)
  - 位置入れ替え
  - 背後からの攻撃ボーナス

### 8.4 デコイ・召喚システム 【優先度: 中】
- **デコイ配置**
  - ヘイト (敵対心) システム
  - タウント効果
  - デコイの耐久値
- **召喚**
  - 一時的な味方エンティティ
  - 召喚物の制御

### 8.5 環境要素 【優先度: 低】
- **部屋形状のバリエーション**
  - 正方形以外の部屋
  - L字型、T字型など
- **障害物**
  - 移動を阻害する地形
  - 遮蔽物
- **トラップ**
  - 敵味方無関係に発動
  - 踏むとダメージ/状態異常
  - トラップの発見・解除

### 8.6 射撃・魔法システム 【優先度: 低】
- **遠距離攻撃**
  - 弓、クロスボウ
  - 射程と命中率
- **魔法攻撃**
  - 属性ダメージ
  - 範囲攻撃の実装 (splash damage)
  - マナシステム

---

## Phase 9: UI/UX改善・最適化

### 9.1 UI/UX改善
- より直感的な操作
- 情報表示の最適化
- アニメーション効果

### 9.2 パフォーマンス最適化
- レンダリング最適化
- メモリ管理
- ゲームループの最適化

### 9.3 ポリッシュ
- サウンド効果
- 視覚効果
- ゲームバランスの最終調整
