# mycrogue - 進捗管理

## プロジェクト概要

- **開始日**: 2025-12-21
- **現在フェーズ**: Phase 3 (ダンジョン) - 未着手
- **前フェーズ**: Phase 2 完了 ✅

---

## 全体進捗

```
Phase 0: 準備・設計         [████████████████████] 100%
Phase 1: コアループ         [████████████████████] 100% ✅
Phase 2: 基本戦闘           [████████████████████] 100% ✅
Phase 3: ダンジョン         [░░░░░░░░░░░░░░░░░░░░]   0%
Phase 4: アイテム・成長     [░░░░░░░░░░░░░░░░░░░░]   0%
Phase 5: メタ進行           [░░░░░░░░░░░░░░░░░░░░]   0%
Phase 6: ボス・バランス     [░░░░░░░░░░░░░░░░░░░░]   0%
Phase 7: 仕上げ             [░░░░░░░░░░░░░░░░░░░░]   0%

全体進捗: 37.5% (Phase 0, 1, 2 完了)
```

---

## Phase 0: 準備・設計 ✅

### 状態: 完了
### 期間: 2025-12-21

#### 完了項目
- [x] 要件定義・ヒアリング
- [x] システム設計
- [x] 関数型スタイル設計への修正
- [x] DESIGN.md 作成
- [x] PLAN.md 作成
- [x] PROGRESS.md 作成

#### 成果物
- [DESIGN.md](DESIGN.md): システム設計書
- [PLAN.md](PLAN.md): 作業計画書
- PROGRESS.md: このファイル

#### メモ
- 関数型プログラミングスタイルを採用
- データと関数を分離
- ピュア関数と副作用の明確な分離

---

## Phase 1: コアループ

### 状態: 完了 ✅
### 目標: 60fps ゲームループと入力システムの基盤構築

#### タスク進捗

##### 1.1 プロジェクト初期化
- [x] ディレクトリ構造作成
- [x] package.json 作成
- [x] tsconfig.json 作成
- [x] .gitignore 作成

##### 1.2 型定義
- [x] `src/types/Input.ts`
- [x] `src/types/GameState.ts`
- [x] `src/core/random.ts`

##### 1.3 入力システム
- [x] `src/input/inputSystem.ts`

##### 1.4 描画システム
- [x] `src/rendering/render.ts`

##### 1.5 ゲームループ
- [x] `src/core/gameLoop.ts`

##### 1.6 動作確認デモ
- [x] `src/main.ts`
- [x] 矢印キーでカーソル移動デモ

#### 完了条件
- [x] 60fps で動作するゲームループ
- [x] キーボード入力の受付
- [x] 画面への文字列描画
- [x] デモが正常にビルド完了

---

## Phase 2: 基本戦闘システム

### 状態: 完了 ✅
### 目標: グリッドベースの戦術戦闘の基礎

#### タスク進捗

##### 2.1 型定義
- [x] `src/types/Entity.ts`
- [x] `src/types/CombatState.ts`

##### 2.2 グリッドシステム
- [x] `src/combat/grid.ts`

##### 2.3 エンティティ操作
- [x] `src/combat/entity.ts`

##### 2.4 タイムラインシステム
- [x] `src/combat/timeline.ts`

##### 2.5 戦闘更新ロジック
- [x] `src/combat/combat.ts`

##### 2.6 戦闘描画
- [x] `src/rendering/formatters.ts`

##### 2.7 動作確認デモ
- [x] 1vs1 戦闘デモ

#### 完了条件
- [x] プレイヤーが敵を倒せる
- [x] 敵のシンプルな AI
- [x] タイムラインゲージが正しく動作

---

## Phase 3: ダンジョンシステム

### 状態: 未着手
### 目標: 部屋の分岐構造とダンジョン探索

#### タスク進捗

##### 3.1 型定義
- [ ] `src/types/Dungeon.ts`

##### 3.2 部屋生成
- [ ] `src/world/room.ts`

##### 3.3 グラフ構造
- [ ] `src/world/graph.ts`

##### 3.4 ダンジョン生成
- [ ] `src/world/dungeon.ts`

##### 3.5 ナビゲーション
- [ ] `src/core/update.ts` 拡張

##### 3.6 ダンジョン描画
- [ ] `src/rendering/formatters.ts` 拡張

##### 3.7 動作確認デモ
- [ ] 簡易ダンジョン探索デモ

#### 完了条件
- [ ] 部屋選択が機能する
- [ ] 戦闘とナビゲーションの切り替え
- [ ] ボス部屋までたどり着ける

---

## Phase 4: アイテム・成長システム

### 状態: 未着手
### 目標: トロフィー・トレジャーとキャラクター成長

#### タスク進捗

##### 4.1 型定義
- [ ] `src/types/Items.ts`

##### 4.2 トロフィーシステム
- [ ] `src/items/trophy.ts`

##### 4.3 トレジャーシステム
- [ ] `src/items/treasure.ts`

##### 4.4 報酬システム
- [ ] `src/core/update.ts` 拡張

##### 4.5 マスターデータ
- [ ] `data/trophies.json`
- [ ] `data/treasures.json`

##### 4.6 報酬描画
- [ ] `src/rendering/formatters.ts` 拡張

##### 4.7 動作確認デモ
- [ ] 報酬選択デモ

#### 完了条件
- [ ] アイテム取得が機能する
- [ ] 効果が正しく適用される
- [ ] プレイヤーが強化される実感

---

## Phase 5: メタプログレッション

### 状態: 未着手
### 目標: プレイ間でのアンロック要素

#### タスク進捗

##### 5.1 型定義
- [ ] `src/types/MetaProgress.ts`

##### 5.2 アンロックシステム
- [ ] `src/progression/meta.ts`

##### 5.3 保存システム
- [ ] `src/progression/save.ts`

##### 5.4 初期化処理
- [ ] `src/main.ts` 修正

##### 5.5 アンロック条件定義
- [ ] `data/unlocks.json`

##### 5.6 動作確認デモ
- [ ] アンロック確認デモ

#### 完了条件
- [ ] セーブデータが正しく保存・読み込み
- [ ] アンロック条件が機能
- [ ] プレイを重ねるごとに選択肢が増える

---

## Phase 6: ボス戦・バランス調整

### 状態: 未着手
### 目標: ボス戦実装とゲームバランス調整

#### タスク進捗

##### 6.1 ボス定義
- [ ] `data/enemies.json` 拡張

##### 6.2 ボス AI
- [ ] `src/combat/ai.ts`

##### 6.3 特殊スキル
- [ ] `src/combat/actions.ts` 拡張

##### 6.4 バランス調整
- [ ] 敵ステータス調整
- [ ] アイテム効果調整
- [ ] タイムライン速度調整
- [ ] AP コスト調整

##### 6.5 テストプレイ
- [ ] プレイ時間確認
- [ ] 難易度曲線チェック
- [ ] アイテムバランスチェック

#### 完了条件
- [ ] ボス戦が楽しい
- [ ] 難易度が適切
- [ ] 1プレイ 30〜40分

---

## Phase 7: 仕上げ・最適化

### 状態: 未着手
### 目標: UI改善、最適化、ポリッシュ

#### タスク進捗

##### 7.1 UI 改善
- [ ] ASCII レイアウト改善
- [ ] 色付け (ANSI)
- [ ] エフェクト表現

##### 7.2 エラーハンドリング
- [ ] 不正入力への対応
- [ ] セーブデータ破損対応
- [ ] エラーメッセージ改善

##### 7.3 パフォーマンス最適化
- [ ] 不要な再計算削減
- [ ] メモ化導入

##### 7.4 ドキュメント整備
- [ ] README.md 作成
- [ ] コメント追加

##### 7.5 最終テスト
- [ ] フルプレイテスト
- [ ] バグ修正
- [ ] エッジケースチェック

#### 完了条件
- [ ] 安定して動作
- [ ] UI が分かりやすい
- [ ] ドキュメントが揃っている

---

## 変更履歴

### 2025-12-21
- プロジェクト開始
- Phase 0 完了: 設計書・計画書作成
- **Phase 1 完了** ✅:
  - プロジェクト初期化: package.json, tsconfig.json, ディレクトリ構造
  - 型定義: Input.ts, GameState.ts, random.ts
  - 入力システム: inputSystem.ts (非同期キューイング)
  - 描画システム: render.ts (ASCII出力)
  - ゲームループ: gameLoop.ts (60fps制御)
  - デモ実装: main.ts (カーソル移動デモ)
  - ビルド成功、dist/ 生成完了

### 2025-12-26
- **Phase 2 完了** ✅:
  - 型定義: Entity.ts, CombatState.ts
  - グリッドシステム: grid.ts (A*パス探索)
  - エンティティ操作: entity.ts
  - タイムラインシステム: timeline.ts (Timeline + AP)
  - 戦闘ロジック: combat.ts
  - 戦闘描画: formatters.ts
  - ゲームループのジェネリック化 (RunnableState)
  - タイムライン蓄積の100停止機能
  - エンティティ位置重複防止機能
  - 固定幅フォーマット表示 (HP/ゲージ)
  - 1vs1 戦闘デモ動作確認

---

## メモ・課題

### Phase 2 で解決した技術課題
- ゲームループの型を `GameState` から `RunnableState` にジェネリック化し、任意の状態構造に対応
- タイムラインゲージが100を超えて蓄積し続ける問題を修正 (100到達時に蓄積停止)
- エンティティが同じ位置に重なる問題を修正 (移動時の衝突判定追加)
- HP/ゲージ表示で桁数が減った際の表示崩れを修正 (固定幅パディング)

### 現在の技術的な検討事項
- Phase 3 でのダンジョングラフ構造の設計
- 部屋間遷移時の状態管理方法

### 今後の拡張案
- Web UI への移植 (Vue.js/React)
- マルチプレイヤー対応
- モバイル対応
- セーブ/ロード機能の強化

---

## 次のアクション

1. Phase 3 の実装準備
2. ダンジョン型定義の作成
3. 部屋生成ロジックの実装

---

_このファイルは各フェーズの進捗に応じて更新されます_
